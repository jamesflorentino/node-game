((function(){var a,b,c,d=function(a,b){return function(){return a.apply(b,arguments)}},e=Object.prototype.hasOwnProperty,f=function(a,b){function d(){this.constructor=a}for(var c in b)e.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};this.Wol,c=Wol.Views,a={marine:{images:["marine.png"],animations:{onMoveEnd:[17,23],onDieStart:[64,91],onDefend:[55,59],onMoveStart:[1,3],onDefendEnd:[60,63],all:[0,0],onMove:[4,16],onDefendStart:[52,54],onAttackStart:[24,51]},frames:{regX:0,width:112,regY:0,height:97,count:92}}},Wol.Units={getAnimation:function(a,b){var c,d,e;return d=this.getFrameData(a,b),e=new SpriteSheet(d),c=new BitmapAnimation(e),c},getFrameData:function(b,c){var d;return d=a[b],d.images=c,d},createUnitByType:function(a){var b;b=null;switch(a){case"marine":b=new Wol.Views.Marine;break;default:b=new Wol.Views.Unit}return b}},b=Wol.Units,Wol.Views.Unit=function(a){function b(){this.moveThroughTiles=d(this.moveThroughTiles,this),b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.init=function(){return this.el=new Container,this.walkSpeed=100,this.commands=new Wol.Models.Commands,this},b.prototype.resetCharge=function(){return this.model.set({charge:0})},b.prototype.spawn=function(){var a,b;return a=this.get("tileX"),b=this.get("tileY"),this.setTilePosition(a,b),this.resetCharge(),this},b.prototype.stand=function(){return this.onStand()},b.prototype.move=function(a){var b;return this.get("tileX")===void 0&&this.get("tileY")===void 0&&(this.setTilePosition(a[0].tileX,a[0].tileY),this.el.x=a[0].x,this.el.y=a[0].y,b=a.splice(0,1),console.log(a,b)),this.moveThroughTiles(a),this},b.prototype.defend=function(){return this.onDefend()},b.prototype.hit=function(){return this.onHit()},b.prototype.performCommand=function(a){return this.onCommand(a)},b.prototype.moveThroughTiles=function(a){var b,c,d=this;return this.onMoveStart(),b=this.el.x,c=Tween.get(this.el),a.forEach(function(a,e){return c=c.call(function(){return d.el.scaleX=a.x>b?1:-1,b=a.x,d.onMove(),d}),c=c.to({x:a.x,y:a.y},d.walkSpeed),d.setTilePosition(a.tileX,a.tileY),d}),c=c.call(function(){return d.onMoveEnd()}),this},b.prototype.flip=function(a){return this.el.scaleX=a==="left"?-1:1,this},b.prototype.setTilePosition=function(a,b){return this.set({tileX:a,tileY:b}),this.el.index=a+b,this},b.prototype.play=function(a){return this.animation||this,this.animation.gotoAndPlay(a),this},b.prototype.onStand=function(){return this},b.prototype.onMove=function(){return this.trigger("move")},b.prototype.onMoveStart=function(){return this},b.prototype.onMoveEnd=function(){return this.trigger("moveEnd")},b.prototype.onSpawn=function(){return this},b.prototype.onHit=function(){return this},b.prototype.onDefend=function(){return this},b.prototype.onCommand=function(a){return this},b}(Wol.Views.View),Wol.Views.AnimatedUnit=function(a){function c(){c.__super__.constructor.apply(this,arguments)}return f(c,a),c.prototype.init=function(){return c.__super__.init.call(this),this.setAnimation(),this.setAnimationEvents(),this.onSpawn(),this},c.prototype.setAnimation=function(){return this.animation=b.getAnimation(this.frameDataName,this.images),this.el.addChild(this.animation),this.animation.gotoAndStop(0),this},c}(Wol.Views.Unit),Wol.Views.Marine=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.setAnimation=function(){return this.walkSpeed=600,this.frameDataName="marine",this.images=[Wol.getAsset("marine")],this.commands.add({name:"Pulse Rifle Shot",code:"marine_pulserifleshot"}),this.el.regX=30,this.el.regY=80,b.__super__.setAnimation.call(this)},b.prototype.setAnimationEvents=function(){var a=this;return this.animation.onAnimationEnd=function(b,c){switch(c){case"onMoveStart":b.gotoAndPlay("onMove");break;case"onMove":b.gotoAndPlay("onMove");break;case"onAttackStart":a.trigger("attackEnd");break;case"onDefend":a;break;case"onDefendStart":break;default:b.gotoAndStop(0)}return a},this},b.prototype.onSpawn=function(){return this.animation.gotoAndStop(0)},b.prototype.onStand=function(){if(this.defending===!0)return this.animation.gotoAndPlay("onDefendEnd"),this.defending=!1},b.prototype.onMoveStart=function(){return this.animation.gotoAndPlay("onMoveStart")},b.prototype.onMoveEnd=function(){return this.animation.gotoAndPlay("onMoveEnd"),b.__super__.onMoveEnd.call(this)},b.prototype.onHit=function(){return this.animation.gotoAndPlay("onDefend")},b.prototype.onDefend=function(){return this.defending=!0,this.animation.gotoAndPlay("onDefendStart")},b.prototype.onCommand=function(a){var b,c=this;switch(a){case"marine_pulserifleshot":this.play("onAttackStart"),b=4;while(b-->0)after(200*b,function(){return c.trigger("attack")})}return this},b}(Wol.Views.AnimatedUnit)})).call(this)